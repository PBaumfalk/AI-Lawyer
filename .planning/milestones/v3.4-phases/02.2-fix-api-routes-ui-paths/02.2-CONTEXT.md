# Phase 2.2: Fix API Routes + UI Paths - Context

**Gathered:** 2026-02-24
**Status:** Ready for planning

<domain>
## Phase Boundary

Fix broken API routes for Ordner-Schemata CRUD (PATCH/DELETE returning 404) and wrong endpoint URL for template favoriting in the Vorlagen overview. Both are gap closures from the v3.4 audit — no new capabilities, just making existing UI flows work.

</domain>

<decisions>
## Implementation Decisions

### Delete confirmation flow
- Confirmation dialog (modal) before deleting an Ordner-Schema
- Dialog shows schema name: "Ordner-Schema «Arbeitsrecht» wirklich löschen?"
- On success: toast "Schema gelöscht" + row/card animates out of list
- On error: error toast with reason, e.g. "Löschen fehlgeschlagen: Schema wird von 3 Akten verwendet"

### Favorit toggle feedback
- Optimistic update — star fills/unfills instantly, reverts on server error
- On error: revert star + subtle toast "Favorit konnte nicht gespeichert werden"
- Favorited templates stay in place (no list reorder on toggle)
- Per-user favorites (not shared/team-level)

### API response shape
- `PATCH /api/ordner-schemata/:id` returns full updated object (200)
- `DELETE /api/ordner-schemata/:id` returns 204 No Content
- PATCH accepts partial updates (only changed fields)
- Validation errors use structured format: `{ error: "Validation failed", fields: { name: "Name darf nicht leer sein" } }`

### Claude's Discretion
- Exact dialog component choice (shadcn AlertDialog or similar)
- Toast implementation details (existing toast system or new)
- Animation style for row removal
- Validation rules for Ordner-Schema fields (follow Prisma schema constraints)

</decisions>

<specifics>
## Specific Ideas

No specific requirements — open to standard approaches following existing codebase patterns.

</specifics>

<deferred>
## Deferred Ideas

- Team-Favoriten — User möchte sowohl User- als auch Team-Favoriten. Per-User wird in dieser Phase gebaut, Team-Favoriten gehören in eine eigene Phase.

</deferred>

---

*Phase: 02.2-fix-api-routes-ui-paths*
*Context gathered: 2026-02-24*
