# Phase 4.1: Wire Akte Real-Time + Email Compose + Admin Pipeline - Context

**Gathered:** 2026-02-24
**Status:** Ready for planning

<domain>
## Phase Boundary

Wire existing Socket.IO rooms, ComposeManager, and admin API endpoints to their UI touchpoints. This closes 3 integration gaps (INT-004, INT-005, INT-006) from the v3.4 audit. No new backend logic — pure cross-phase wiring of code built in Phases 1, 3.1, and 4.

</domain>

<decisions>
## Implementation Decisions

### OCR status display
- Spinner + status text ("OCR läuft...") in the upload panel while processing
- On success: fade transition to green checkmark + "OCR abgeschlossen"
- On failure: red error text "OCR fehlgeschlagen" + retry icon button to re-trigger processing
- Status visible in upload panel only (not on document list or detail views)

### Admin pipeline dashboard
- Dedicated admin page at `/admin/pipeline` (new page, not embedded in existing settings)
- Display queue counts (pending/processing/completed/failed) per queue (OCR, embedding) + recent jobs table with status and timestamps
- Auto-refresh via polling every 10–30 seconds
- Retry button per failed job row — admin can trigger reprocessing from the dashboard

### Neue E-Mail button
- Floating action button (FAB) in bottom-right corner, styled like Gmail's compose FAB
- Pen/edit icon + "Neue E-Mail" text label
- Visible on all email-related pages (inbox, sent, drafts, email detail)
- Multiple concurrent compose windows allowed — clicking FAB when compose is already open opens a second compose window via ComposeManager

### Real-time notifications
- Toast notification when OCR completes: "OCR abgeschlossen: {filename}" — auto-dismisses
- Toast is clickable — navigates to the document detail/preview
- Notifications fire globally across the app, not just when viewing the Akte
- OCR failure also triggers error toast: "OCR fehlgeschlagen: {filename}" with retry action button

### Claude's Discretion
- Toast auto-dismiss timing and animation
- Polling interval (within 10–30s range) for admin dashboard
- FAB positioning offset and responsive behavior
- Exact retry mechanism implementation (API endpoint to call)

</decisions>

<specifics>
## Specific Ideas

- FAB for compose follows Gmail mobile pattern — pen icon + label text, bottom-right
- Multiple concurrent compose windows like Outlook (not single-compose like basic email clients)
- Toast notifications are the standard pattern for real-time status updates throughout the app
- Admin pipeline dashboard should show both OCR and embedding queues side by side

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 04.1-wire-akte-realtime-email-compose-admin-pipeline*
*Context gathered: 2026-02-24*
