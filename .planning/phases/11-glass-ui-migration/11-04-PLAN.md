---
phase: 11-glass-ui-migration
plan: 04
type: execute
wave: 3
depends_on:
  - 11-02
  - 11-03
files_modified:
  - src/app/(dashboard)/dashboard/page.tsx
  - src/app/(dashboard)/akten/page.tsx
  - src/app/(dashboard)/akten/[id]/page.tsx
  - src/app/(dashboard)/akten/[id]/emails/page.tsx
  - src/app/(dashboard)/akten/[id]/dokumente/[docId]/page.tsx
  - src/app/(dashboard)/akten/neu/page.tsx
  - src/components/akten/akte-detail-tabs.tsx
  - src/components/akten/akte-detail-header.tsx
  - src/components/akten/akten-search-bar.tsx
autonomous: true
requirements:
  - UI-01
  - UI-03

must_haves:
  truths:
    - "Dashboard page KPI grid uses glass-panel wrapper around the GlassKpiCard grid"
    - "Dashboard page 'Zuletzt bearbeitete Akten' and 'Anstehende Fristen' cards use glass-card class explicitly"
    - "Akten-Liste page wraps its table/list in a glass-panel"
    - "Akten-Liste search bar uses glass-input styled input"
    - "Akte-Detail page tabs and content panes use glass-panel/glass-card"
    - "Akte-Neu form page wraps form sections in glass-panel containers"
    - "No page uses raw white/gray div where glass-card or glass-panel should be"
    - "List items have stagger fade-in animation (max 10 items, rest instant)"
  artifacts:
    - path: "src/app/(dashboard)/dashboard/page.tsx"
      provides: "Dashboard with glass-panel section wrappers, GlassKpiCard grid, staggered recent-akten list"
    - path: "src/app/(dashboard)/akten/page.tsx"
      provides: "Akten-Liste wrapped in glass-panel, glass-input search"
    - path: "src/app/(dashboard)/akten/[id]/page.tsx"
      provides: "Akte-Detail with glass-panel tabs shell"
    - path: "src/app/(dashboard)/akten/neu/page.tsx"
      provides: "Akte-Neu form in glass-panel containers"
    - path: "src/components/akten/akte-detail-tabs.tsx"
      provides: "Tabs with glass-card content panes and staggered list items"
  key_links:
    - from: "src/app/(dashboard)/dashboard/page.tsx"
      to: "src/components/ui/glass-kpi-card.tsx"
      via: "GlassKpiCard with count-up (numeric values passed)"
      pattern: "GlassKpiCard"
    - from: "src/app/(dashboard)/akten/page.tsx"
      to: "src/components/ui/glass-panel.tsx"
      via: "GlassPanel wrapping the list table"
      pattern: "GlassPanel"
---

<objective>
Migrate Dashboard and Akten pages to the upgraded glass design language. Apply glass-panel/glass-card to all section containers. Add staggered animations to list items. Ensure all form sections use glass-panel wrappers.

Purpose: Dashboard and Akten are the two most-used pages. Migrating them validates the design system in production context and addresses requirements UI-01 and UI-03 directly.
Output: Dashboard + all Akten pages (list, detail, sub-pages, new form) using consistent glass design language.
</objective>

<execution_context>
@/Users/patrickbaumfalk/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patrickbaumfalk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/11-glass-ui-migration/11-CONTEXT.md
@.planning/phases/11-glass-ui-migration/11-01-SUMMARY.md
@.planning/phases/11-glass-ui-migration/11-03-SUMMARY.md

<interfaces>
<!-- Animation pattern for staggered list items (from CONTEXT.md): -->
<!-- "use client" component needed for animations -->
<!-- import { motion } from "motion/react" -->
<!-- Max 10 staggered items — rest appear instantly -->
<!-- Pattern: -->
<!--   {items.slice(0, 10).map((item, i) => ( -->
<!--     <motion.div -->
<!--       key={item.id} -->
<!--       initial={{ opacity: 0, y: 8 }} -->
<!--       animate={{ opacity: 1, y: 0 }} -->
<!--       transition={{ delay: i * 0.05, duration: 0.2 }} -->
<!--     > -->
<!--       {renderItem(item)} -->
<!--     </motion.div> -->
<!--   ))} -->
<!--   {items.slice(10).map((item) => renderItem(item))} -->

<!-- Page-enter animation: -->
<!-- Wrap page content in: -->
<!-- <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ duration: 0.15 }}> -->

<!-- GlassPanel import: -->
<!-- import { GlassPanel } from "@/components/ui/glass-panel" -->
<!-- import { GlassCard } from "@/components/ui/glass-card" -->

<!-- Dashboard page currently: -->
<!-- - Uses GlassKpiCard (already imported) — keep, values are numeric (count-up works) -->
<!-- - Uses GlassCard for recent-akten and fristen cards (already glass-card) -->
<!-- - h1 heading uses font-heading — replace with just font-semibold (SF Pro system font now) -->

<!-- Akten page structure (src/app/(dashboard)/akten/page.tsx): -->
<!-- - Server component — can add client wrapper for animations -->
<!-- - Has table or list of akten — wrap in GlassPanel -->

<!-- Akten-Detail (src/app/(dashboard)/akten/[id]/page.tsx): -->
<!-- - Uses AkteDetailTabs component -->
<!-- - Has akte-detail-header -->
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Dashboard page + add stagger animation to recent-akten list</name>
  <files>src/app/(dashboard)/dashboard/page.tsx</files>
  <action>
    The dashboard page is a server component. Add a client wrapper component for animations.

    **Changes to make:**

    1. **Page-enter animation:** The page itself is server-side. Create an inline `"use client"` wrapper component at the top of the file OR extract to a component file. Simpler approach: wrap the returned JSX in a div with CSS `animate-in fade-in duration-150` (Tailwind animation class) — no Motion needed for server components.

    Actually: since this is a server component, use `@layer utilities` CSS instead. Add class to outer div: `"space-y-6 animate-in fade-in duration-150"` (tailwind-animate or simple CSS). If tailwind-animate is not installed, just add inline style `style={{ animationDuration: "150ms" }}` — skip this if it adds complexity. Focus on glass styling.

    2. **Heading font:** Replace `font-heading` class with `font-semibold` (no heading font class needed — system font handles it). The h1: `<h1 className="text-2xl font-semibold text-foreground">`.

    3. **KPI section wrapper:** Wrap the stats grid div in a section with subtle spacing:
    ```tsx
    <section className="space-y-3">
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        {/* GlassKpiCards — keep as-is, count-up added in Plan 03 */}
      </div>
    </section>
    ```

    4. **Tagesuebersicht:** Wrap in GlassPanel:
    ```tsx
    <GlassPanel elevation="panel">
      <Tagesuebersicht />
    </GlassPanel>
    ```
    Add: `import { GlassPanel } from "@/components/ui/glass-panel"`

    5. **Recent Akten + Fristen cards:** The two GlassCard usages already use glass — upgrade them to include a proper header:
    - Add `className="p-0"` on GlassCard, add a `<div className="px-6 py-4 border-b border-[var(--glass-border-color)]">` for the h2 heading, then `<div className="p-6">` for content.
    - This creates a visual card-with-header structure.
    - Replace `font-heading` on h2 elements with `font-semibold`.

    6. **Stagger animation for recent akten list:** Convert the letzteAkten.map to use staggered animation.
    Since the page is a server component, create a small client component:
    ```tsx
    // Inline at bottom of file or inline helper:
    // "use client"
    // function StaggeredList({ children }: { children: React.ReactNode[] }) { ... }
    ```
    Actually: The simplest approach for a server component is to use CSS animation-delay inline styles:
    ```tsx
    {letzteAkten.map((akte, i) => (
      <Link
        key={akte.id}
        href={`/akten/${akte.id}`}
        className="flex items-center justify-between p-3 rounded-lg hover:bg-white/30 dark:hover:bg-white/[0.05] transition-colors -mx-1"
        style={i < 10 ? { animationDelay: `${i * 50}ms`, animationFillMode: "both" } : undefined}
      >
        {/* ... existing content ... */}
      </Link>
    ))}
    ```
    Add to globals.css if not present: `@keyframes list-item-in { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }` and `.list-item-in { animation: list-item-in 0.2s ease-out both; }` — then add class `list-item-in` to each Link for i < 10. For i >= 10, no class (instant). This avoids needing "use client" on the server page.
  </action>
  <verify>
    Load /dashboard. KPI cards count up from 0. "Zuletzt bearbeitete Akten" list items fade in sequentially. Cards have header-separator style. Tagesuebersicht is in a glass panel. No visual regressions.
  </verify>
  <done>Dashboard uses GlassPanel for Tagesuebersicht, glass card-with-header pattern for recent Akten and Fristen, CSS-based stagger animation for list items, font-semibold instead of font-heading.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate Akten list page, Akte-Detail shell, and Akte-Neu form</name>
  <files>
    src/app/(dashboard)/akten/page.tsx
    src/app/(dashboard)/akten/[id]/page.tsx
    src/app/(dashboard)/akten/[id]/emails/page.tsx
    src/app/(dashboard)/akten/[id]/dokumente/[docId]/page.tsx
    src/app/(dashboard)/akten/neu/page.tsx
    src/components/akten/akte-detail-tabs.tsx
    src/components/akten/akte-detail-header.tsx
    src/components/akten/akten-search-bar.tsx
  </files>
  <action>
    Read each file before modifying. Apply the following changes:

    **src/app/(dashboard)/akten/page.tsx:**
    - Wrap entire content in a top-level div with `space-y-4`.
    - Any table/list container that uses `bg-white`, `bg-card`, or similar → replace with `<GlassPanel>` wrapper.
    - Any search bar area → ensure it uses glass-input (likely via akten-search-bar component already).
    - Replace `font-heading` on headings with `font-semibold`.
    - If there's a filter/toolbar bar → wrap in `<div className="glass-card rounded-xl p-3 flex items-center gap-3">`.

    **src/app/(dashboard)/akten/[id]/page.tsx:**
    - Wrap the outer layout (header + tabs) in a `space-y-4` div.
    - Ensure AkteDetailHeader uses glass-card.
    - The main tab area: verify AkteDetailTabs is the primary component.

    **src/components/akten/akte-detail-header.tsx:**
    Read the file first. Likely has a card/div with bg-white or similar.
    - Replace outer div with `<GlassPanel>` or ensure className includes `glass-card`.
    - Add `import { GlassCard } from "@/components/ui/glass-card"` if not present.
    - Replace any hardcoded `bg-white dark:bg-gray-900` with `glass-card`.

    **src/components/akten/akte-detail-tabs.tsx:**
    Read the file first. This is the tabbed interface for Akte detail.
    - Each tab panel content area → wrap with `<div className="glass-card rounded-xl p-4">` or `<GlassCard>`.
    - Table inside tabs → ensure it's in a GlassPanel.
    - Replace `font-heading` with `font-semibold` on any headings inside.
    - If it has a list of items (documents, emails, etc.) → add CSS stagger animation (i * 50ms delay, class `list-item-in`, max 10 items).

    **src/components/akten/akten-search-bar.tsx:**
    Read the file. The search input should already use the Input component.
    - If it uses `<Input>` from "@/components/ui/input" → it automatically gets glass-input styling (upgraded in Plan 03).
    - If it renders a raw `<input>` → replace with `<Input>` component import.

    **src/app/(dashboard)/akten/neu/page.tsx:**
    Read the file. Form for creating new Akte.
    - Wrap each logical form section (Grunddaten, Beteiligte, etc.) in `<GlassPanel elevation="panel" className="p-6 space-y-4">`.
    - Outer page wrapper: `<div className="max-w-3xl mx-auto space-y-6">`.
    - Form heading: `<h1 className="text-2xl font-semibold text-foreground">`.
    - All `<Input>` and `<Select>` components automatically have glass-input from Plan 03.
    - Submit button: already uses Button component → gets Motion spring from Plan 03.

    **src/app/(dashboard)/akten/[id]/emails/page.tsx and dokumente/[docId]/page.tsx:**
    Read each file. Apply basic glass-panel wrappers to main content containers. Replace any explicit bg-white/bg-card classes with glass-card or glass-panel as appropriate for the content density.
  </action>
  <verify>
    Visit /akten — list wrapped in glass panel. Visit /akten/[existing-id] — tabs work, content in glass cards. Visit /akten/neu — form sections in glass panels. All glass-input styled inputs visible. No TypeScript errors (`npx tsc --noEmit`).
  </verify>
  <done>Akten list in glass-panel. Akte detail header + tabs in glass-card. Akte-neu form in glass-panel sections. akten-search-bar uses Input component (glass-input). No TS errors.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` — zero errors
2. Visual /dashboard: KPI count-up, stagger list animation, Tagesuebersicht in glass panel
3. Visual /akten: list table in glass-panel, search bar glass-input
4. Visual /akten/[id]: tabs in glass shell, detail header in glass-card
5. Visual /akten/neu: form sections in glass panels, inputs glass-input styled
6. Dark mode: toggle in sidebar → all pages switch theme correctly
</verification>

<success_criteria>
- Dashboard: GlassPanel for Tagesuebersicht, stagger CSS animation for list items, font-semibold headings
- Akten-Liste: list in GlassPanel, search bar uses Input (glass-input)
- Akte-Detail: header in glass-card, tabs content in glass-card panels
- Akte-Neu: form sections in GlassPanel, all inputs glass-input
- Zero TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/11-glass-ui-migration/11-04-SUMMARY.md`
</output>
